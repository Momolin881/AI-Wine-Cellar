# AI Wine Cellar 功能規劃路線圖

## 待開發功能

---

### 1. 多瓶酒獨立追蹤 (Individual Bottle Tracking)

**問題描述：**
目前數量 > 1 時，以單筆記錄儲存 `quantity: N`，但每瓶酒的狀態可能不同（開瓶/未開瓶、送禮、轉賣等）。

**解決方案：**

#### 資料層
- 新增時若 `quantity > 1`，自動拆分為多筆獨立記錄
- 每瓶獨立追蹤狀態
- 價格按瓶均攤（或可個別設定）
- 可考慮新增 `batch_id` 欄位，標記同一批購入的酒款

#### 顯示層
- 酒窖首頁：相同酒款（同名 + 同年份 + 同酒莊）合併為單張卡片
- 卡片顯示：總數量、狀態摘要（如「2瓶未開/1瓶已開」）
- 點擊卡片：展開「瓶列表」，可個別管理每瓶狀態

#### 影響範圍
- `POST /wine-items` - 拆分邏輯
- `WineHome.jsx` - 合併顯示邏輯
- `WineDetailModal.jsx` - 瓶列表 UI
- 統計計算邏輯調整

---

### 2. 歷史酒款智慧識別 (Historical Wine Recognition)

**功能描述：**
當使用者再次購買曾經買過的酒款，AI 辨識時提供歷史資訊參考。

**用戶流程：**
```
拍照上傳
    ↓
AI 辨識酒標
    ↓
比對歷史資料庫（包含已喝完的酒）
    ↓
發現曾購買過
    ↓
顯示提示訊息 + 舊資料
```

**顯示資訊：**
| 欄位 | 行為 |
|------|------|
| 酒名、酒類、年份等 | 自動帶入 |
| 上次購買價格 | 顯示參考，可編輯新價格（發現變貴/便宜）|
| 購買日期 | 預設當天，顯示上次購買時間供參考 |
| 品飲筆記 | 顯示舊筆記，可新增/編輯 |
| 購買次數 | 顯示「這是您第 N 次購買此酒款」|

**技術實作：**

#### 後端
- 歷史酒款資料保留（`status = consumed/sold/gifted` 的記錄不刪除）
- 新增 API：`GET /wine-items/history/match?name=xxx&vintage=xxx`
- 模糊比對邏輯（酒名相似度、同酒莊同年份等）

#### 前端
- AI 辨識成功後，呼叫歷史比對 API
- 若有匹配，顯示提示 Modal 或區塊
- 使用者可選擇「使用舊資料」或「重新輸入」

#### 影響範圍
- `POST /wine-items/recognize` - 增加歷史比對邏輯
- `AddWineItem.jsx` - 顯示歷史資料提示 UI
- 資料庫查詢優化（歷史記錄索引）

---

### 3. 相關功能（未來考慮）

- [ ] 酒款收藏清單（想買但還沒買）
- [ ] 價格趨勢追蹤（同款酒的價格變化）
- [ ] 品飲筆記模板（結構化紀錄：香氣、口感、餘韻等）
- [ ] 酒款評分系統
- [ ] 社群分享功能

---

## 版本規劃

| 版本 | 功能 | 狀態 |
|------|------|------|
| v0.1.x | MVP - 基本入庫、管理、開瓶追蹤 | ✅ 已上線 |
| v0.2.0 | 多瓶獨立追蹤 | 📋 規劃中 |
| v0.3.0 | 歷史酒款智慧識別 | 📋 規劃中 |

---

*最後更新：2026-01-28*
